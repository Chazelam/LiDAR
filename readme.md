# LAS_split
Разбиение файла на сектора без загрузки всего файла в память.
При разбиение сохраняется доп. информация о точках.

## Todo:
- [x] Добавить зазоры
- [ ] При разбиении без зазоров сумма файлов превосходит исходный на ~10%, найти причину
>На первый взгляд сумма заголовков не соответствует разнице

- [ ] Сейчас есть ощущение что зазоры не совсем корректно работают, провести тесты.
- [ ] Добавлять информацию о разбиение в header - Description, в частности размер и зазоры
- [ ] Параметр chunk_size не в точках, а в требуемом объеме ОЗУ
- [ ] Добавить многопоточность
- [ ] Прибраться в комментариях
  

# LAS_merge
Сейчас оставляет файл с отверстиями, такое ощущение что большие сектора не итерируются, можно попробовать загружать полностью для проверки.


# PMF filter
Перевел на векторные вычисления, ускорив работу в 60+ раз.
Исходный скрипт обрабатывал файл 40М точек больше 20 минут, новый - 26 секунд.

Исправил сохранение, изначально неверно копировались атрибуты. В новый las брались атрибуты первых n точек, а сами точки были произвольные из-за чего они мешались.
Заменил на применение маски к всему las объекту.

## Todo:
- [ ] Желательно добавить хоть какой нибудь прогресс бар
- [ ] Протестировать зависимость настроек фильтра.


# Normalization
Очень зависит от определения земли, добавляет шум, не уверен что она нам в целом нужна если мы будем отделять деревья.
  

# Density filter
Работает, но нужно переписать без итерации (не все соседи поподают в чанк) и сократить вычисления.
Найтии оптимальный порог плотности, поиграться с параметрами.


---

# Ссылки
[LAS format Specification](https://www.asprs.org/a/society/committees/standards/asprs_las_format_v12.pdf)

[laspy documentation](https://laspy.readthedocs.io/en/latest/intro.html#header)
[laspy.lasappender — laspy 2.5.0 documentation](https://laspy.readthedocs.io/en/latest/_modules/laspy/lasappender.html#LasAppender)

[lasview - LAStools documentation](https://downloads.rapidlasso.de/html/lasview_README.html)
